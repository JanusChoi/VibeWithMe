# 人类与AI协同工作流程标准

## 📋 核心理念

这个工作流程设计用于**单一开发者与AI协同开发**的场景。

核心原则：
- 🎯 **文档驱动** - AI通过清晰的文档理解需求和设计
- 🤖 **AI友好** - 结构化信息便于AI处理和执行
- 📝 **最小化上下文** - 避免无关信息，让AI专注核心任务
- 🔄 **迭代优化** - 每个阶段都有明确的验收标准

---

## 🔄 核心工作流程

```
用户故事
    ↓ (需求明确)
产品设计文档
    ↓ (方案定案)
Sprint规划
    ↓ (任务分解)
开发排期
    ↓ (优先级确定)
AI执行开发
    ↓ (代码交付)
验收&优化
    ↓ (问题反馈)
迭代下一Sprint
```

### 各阶段职责

| 阶段 | 人类职责 | AI职责 | 产出 |
|------|---------|--------|------|
| 用户故事 | 描述功能需求 | 理解和澄清 | USER_STORIES.md |
| 产品设计 | 确认功能流程和界面 | 设计技术方案 | DESIGN.md |
| Sprint规划 | 确定优先级 | 分解和排期 | IMPLEMENTATION_PLAN.md |
| 开发执行 | - | 编码和测试 | 代码 + 进度文档 |
| 验收 | 测试功能&反馈 | 修复问题 | - |

---

## 📖 第一步：用户故事

### 用户故事格式

结构化地描述需求，让AI清晰理解：

```markdown
# 用户故事

## 故事1: [功能名称]

**用户角色**: 谁
**用户目标**: 想要做什么
**目的**: 为什么要这样做

### 详细描述
对功能的详细说明...

### 验收标准
- [ ] 条件1
- [ ] 条件2
- [ ] 条件3

### 约束条件
- 性能要求：必须在3秒内完成（用业务语言，不要技术指标）
- 兼容性要求：需要支持Windows/Mac/Android/Apple系统
- 安全要求：用户数据必须加密存储

### 依赖关系
依赖于哪些其他故事或系统...

---
```

### 示例

```markdown
# 用户故事

## 故事1: 用户登录功能

**用户角色**: 新用户
**用户目标**: 能够用邮箱和密码登录系统
**目的**: 访问个人账户和数据

### 详细描述
1. 用户访问登录页面
2. 输入邮箱和密码
3. 点击登录按钮
4. 系统验证凭证
5. 登录成功后跳转到主页

### 验收标准
- [ ] 登录页面能正确显示
- [ ] 正确的邮箱密码可以登录
- [ ] 错误的密码显示错误提示
- [ ] 登录成功后保存session
- [ ] 页面响应时间<500ms

### 约束条件
- 密码必须加密存储
- 支持浏览器: Chrome/Firefox/Safari最新版
- 必须支持HTTPS

### 依赖关系
- 依赖于用户注册功能
- 依赖于数据库用户表
```

---

## 🎨 第二步：产品设计文档

这是人类描述"要做什么"的关键文档。清晰的需求让AI能准确设计和实现。

### 设计文档结构（给产品经理）

```markdown
# 产品设计文档

## 1. 功能概述

这个版本要实现什么功能？解决用户的什么问题？

## 2. 用户流程

### 用户看到什么、做什么

描述用户的完整操作流程：
1. 用户打开应用，看到XX界面
2. 点击XX按钮，进入XX页面
3. 输入XX信息，点击保存
4. 系统显示XX结果

### 关键界面

- **登录页面**: 需要邮箱、密码输入框和登录按钮
- **主页面**: 显示用户的XX列表，可以筛选和排序
- **详情页面**: 显示单个项目的详细信息和操作按钮

## 3. 功能要求

### 必须实现的功能
- [ ] 用户可以登录
- [ ] 用户可以查看列表
- [ ] 用户可以添加新项目

### 可选功能
- [ ] 导出数据
- [ ] 批量操作

## 4. 业务规则

描述业务逻辑（不是技术实现）：
- 只有登录用户才能查看数据
- 每个用户最多创建100个项目
- 删除操作需要二次确认

## 5. 性能期望（用业务语言）

- 页面打开速度：不超过3秒
- 支持用户量：预计X人同时使用
- 数据量：预计存储XX条记录

## 6. 特殊考虑

- 是否需要离线使用？
- 数据是否敏感（关系到存储方式）？
- 有没有兼容性要求（老电脑、老系统）？

---
```

### 人类只需要提供

- ✅ **功能描述** - 要做什么功能
- ✅ **用户流程** - 用户怎样操作
- ✅ **界面要求** - 界面上要有什么
- ✅ **业务规则** - 业务逻辑是什么
- ✅ **验收标准** - 什么时候算完成

### AI自己决定

- 🤖 **技术栈** - 用什么框架和语言
- 🤖 **系统架构** - 怎样分层和组织代码
- 🤖 **数据库设计** - 表结构、索引、关系
- 🤖 **API设计** - 接口定义和格式
- 🤖 **性能优化** - 缓存、异步、优化策略

### 关键原则

**人类提供业务逻辑，AI负责技术实现**

示例对比：
```
❌ 不好：人类说"用户表需要id、email、password_hash字段"
✅ 好的：人类说"用户需要用邮箱和密码登录"
        → AI自己决定数据库设计

❌ 不好：人类说"用PostgreSQL而不是MySQL"
✅ 好的：人类说"预计10万用户"
        → AI自己选择合适的数据库

❌ 不好：人类说"API响应格式用JSON，包含code、message、data"
✅ 好的：人类说"操作失败时要给出清晰的错误提示"
        → AI自己设计API格式
```

---

## 📅 第三步：Sprint规划与排期

这个阶段人类做优先级决策，AI做任务分解。

### Sprint规划文档

```markdown
# Sprint规划

## Sprint 目标

用一句话表述这个Sprint的核心目标...

## 优先级排序

### P0 - 必须完成 (核心功能)
1. 任务1: ...
2. 任务2: ...

### P1 - 高优先级 (重要功能)
1. 任务3: ...
2. 任务4: ...

### P2 - 中优先级 (补充功能)
1. 任务5: ...

### P3 - 低优先级 (优化改进)
1. 任务6: ...

## Sprint时间框

- 开始日期: 2025-XX-XX
- 结束日期: 2025-XX-XX
- 预计工作量: N天

## 验收标准

Sprint完成时必须满足：
- [ ] P0任务全部完成
- [ ] 代码质量达标（覆盖率≥70%）
- [ ] 文档已更新
- [ ] 基础测试通过
```

### 什么时候使用Sprint

- **使用Sprint**: 项目大于2周
- **跳过Sprint**: 小于2周的项目，直接到开发排期

---

## 🎯 第四步：开发排期与任务

这是AI开发的直接指令。任务必须：
1. **清晰明确** - AI能够理解
2. **独立完整** - 不依赖其他任务的理解
3. **有验收标准** - AI知道什么时候完成

### 任务格式

```markdown
# 任务清单

## 任务1: [任务名称]

**优先级**: P0 / P1 / P2 / P3
**预计工时**: X天（AI参考，不强制）
**前置任务**: 任务A, 任务B（可选）

### 需求说明
详细描述这个任务需要完成什么...

### 技术细节
- 应该使用什么框架/库
- 应该如何集成到现有系统
- 有哪些特殊要求

### 验收标准
AI完成时必须满足：
- [ ] 功能如需求所述
- [ ] 代码质量达标
- [ ] 包含单元测试
- [ ] 已更新相关文档
- [ ] 没有已知bug

### 完成后提交

提交以下文件：
- 代码（push到分支）
- 测试用例
- 文档更新
- 状态更新到本文件

---
```

### 进度跟踪

简洁的进度记录：

```markdown
# 开发进度

## 当前Sprint: Sprint 1

| 任务 | 优先级 | 状态 | 完成度 |
|------|--------|------|--------|
| 任务1 | P0 | ✅ 完成 | 100% |
| 任务2 | P0 | 🔄 进行中 | 70% |
| 任务3 | P1 | ⏳ 等待 | 0% |

## 上次更新
- 日期: 2025-10-24
- 人类反馈: ...
- 下一步: ...
```

---

## ✅ 完成的定义 (DoD)

AI完成一个任务时必须满足（对AI的要求）：

### 功能层面
- [ ] 功能按需求实现且工作正常
- [ ] 没有明显的bug
- [ ] 符合验收标准

### 质量层面（AI自己控制）
- [ ] 代码质量达标（可读、有注释、符合规范）
- [ ] 测试充分（AI自己决定测试策略和覆盖率）
- [ ] 性能符合要求

### 交付层面
- [ ] 代码已提交
- [ ] 相关文档已更新
- [ ] 可以直接使用

### 对产品经理
人类**不需要检查代码质量细节**（如覆盖率、注释等），只需要：
- ✅ 测试功能是否符合需求
- ✅ 确认验收标准是否通过
- ✅ 发现问题及时反馈

---

## 🔍 问题跟踪

虽然是单人+AI，但问题跟踪仍然重要。

### 问题分类

```
🔴 P0 - BLOCKER
   影响：核心功能完全不可用
   示例：程序崩溃、数据丢失、安全漏洞
   处理：立即停止，修复后再继续

🟠 P1 - CRITICAL  
   影响：核心功能有严重缺陷
   示例：查询结果错误、计算不准确
   处理：立即修复

🟡 P2 - IMPORTANT
   影响：功能不完整或性能问题
   示例：搜索慢、某些场景无法使用
   处理：本Sprint内修复

🟢 P3 - NICE-TO-HAVE
   影响：用户体验优化
   示例：界面美化、提示信息改进
   处理：有时间再做
```

### 问题记录

```markdown
# 问题记录

## 问题1: [标题]

**优先级**: P0 / P1 / P2 / P3
**发现时间**: YYYY-MM-DD
**发现方式**: 开发中 / 测试时 / 用户反馈

### 问题描述
清楚描述现象...

### 复现步骤
1. ...
2. ...
3. ...

### 期望行为
应该怎样...

### 实际行为
实际怎样...

### 根本原因分析
为什么会这样...

### 解决方案
怎样修复...

### 验证结果
修复是否成功...

---
```

---

## 📊 进度同步方式

由于是人类与AI协作，进度同步非常关键。

### 每日进度更新（由AI维护）

```markdown
# 日期: 2025-10-24

## 今天完成
- 功能A的后端API实现
- 编写了15个单元测试

## 目前进行中
- 功能A的前端集成（预计明天完成）

## 遇到的问题
- 问题描述: ...
- 影响: ...
- 建议方案: ...
- 需要人类决策: YES/NO

## 下一步计划
明天计划完成功能A的前端集成，然后开始功能B的设计审查。

## 代码统计
- 新增代码: 500行
- 修改代码: 200行
- 删除代码: 50行
- 测试覆盖率: 75%
```

### 人类反馈方式

```markdown
# 人类反馈 - 2025-10-24

## 对进度的评价
进度达到预期/超前/延迟。

## 问题反馈
- 功能A在XX场景下有问题，需要修复
- 代码风格需要调整

## 方向修正
- 优先级调整: 原来的P1改为P2
- 新增需求: ...

## 下一步指示
下一步专注于...，完成XX任务。

## 预期下次同步
2025-10-25下午
```

---

## 🚀 版本发布流程

即使是单人项目，也需要规范的发布流程。

### 发布前检查清单

```
一周前
☑️ 确认所有P0任务完成
☑️ 确认P1任务的状态（完成或推迟）

三天前
☑️ 功能测试通过
☑️ 没有已知的P0/P1 bug
☑️ 文档已更新

一天前
☑️ 编写发布说明（RELEASE_NOTES.md）
☑️ 编写更新日志（CHANGELOG.md）
☑️ 版本号确定

发布当天
☑️ 构建验证通过
☑️ 发布说明已准备
☑️ 用户通知已准备

发布后
☑️ 监控运行状态
☑️ 收集用户反馈
☑️ 准备hotfix方案
```

### 发布说明格式

```markdown
# v1.1.0 发布说明

## 发布日期
2025-10-31

## 核心功能
这个版本添加了...

## 新增功能
- 功能A: 详细说明
- 功能B: 详细说明

## 改进
- 性能提升: ...
- 用户体验: ...

## 已知问题
- 问题1: ...，预计在v1.2.0修复
- 问题2: ...

## 升级说明
用户需要做什么来升级...
```

---

## 📚 完成的定义（整体视角）

一个版本"完成"应该包括：

| 维度 | 标准 |
|------|------|
| 功能 | 所有P0任务完成，P1任务状态明确 |
| 质量 | 代码覆盖率≥70%，没有P0/P1 bug |
| 文档 | 设计文档更新，API文档完整，README清晰 |
| 发布 | 发布说明准备，版本号确定，可以部署 |

---

## 💡 人类与AI协作的最佳实践

### 1. 文档要清晰

```
❌ 不清晰: "实现用户管理功能"
✅ 清晰: "实现用户注册功能，包括邮箱验证、密码加密、重复检查"
```

### 2. 需求要完整

在让AI开发之前，确保：
- 功能的完整描述
- 相关的系统设计
- 性能和兼容性要求
- 已知的限制

### 3. 验收标准要具体

```
❌ 模糊: "功能应该工作良好"
✅ 具体: "功能应该在<500ms内返回结果，支持1000并发"
```

### 4. 问题反馈要及时

发现问题立即记录，包括：
- 具体现象
- 复现步骤
- 期望结果
- 建议的优先级

### 5. 保持进度透明

定期查看AI的进度报告，了解：
- 完成了什么
- 遇到了什么问题
- 下一步是什么

---

## 🎯 典型工作日流程

```
09:00 - 早间同步 (10分钟)
       查看AI的昨天进度报告
       确认今天的优先级

09:10 - 任务下达 (如需要)
       如果新的需求或方向调整
       更新任务文档和优先级

09:30 - 18:00 - AI开发
        AI自主执行任务
        人类可以做其他工作

16:00 - 进度检查 (可选)
       查看当前进度
       确认是否有阻塞

18:00 - 晚间同步 (10-20分钟)
       查看今天的成果
       给出明天的方向
       记录问题和反馈
```

---

## 📋 文档清单

人类与AI协作需要维护以下文档：

| 文档 | 更新者 | 更新频率 | 用途 |
|------|--------|---------|------|
| USER_STORIES.md | 人类 | 版本启动时 | 需求定义 |
| DESIGN.md | 人类 + AI | 版本设计时 | 系统设计 |
| IMPLEMENTATION_PLAN.md | 人类 (优先级) + AI (分解) | Sprint开始 | 任务计划 |
| PROGRESS_REPORT.md | AI | 每天更新 | 进度跟踪 |
| ISSUES.md | AI (记录) + 人类 (决策) | 发现问题时 | 问题跟踪 |
| RELEASE_NOTES.md | AI + 人类审核 | 版本发布时 | 发布说明 |
| LESSONS_LEARNED.md | 人类 | 版本完成后 | 经验总结 |

---

**版本**: v2.0 (为人类与AI协同设计)  
**最后更新**: 2025年10月
